# 测试: 前端组件重构（Level 3 - 重构场景）

## 元信息
- **Level**: 3
- **类型**: refactor
- **决策点数量**: 1
- **风险等级**: medium

## 原始输入
Plan: 重构 UserProfile 组件，提高可复用性

## 当前问题
UserProfile 组件目前：
- 代码行数 800+，职责过多（展示+编辑+验证）
- 多处重复逻辑（头像上传、表单验证）
- 难以在不同页面复用（需要传递 15+ 个 props）

## 重构方案

### 选项 A: 提取子组件（推荐）
拆分为 4 个独立组件：
- `AvatarUploader` - 头像上传（可复用）
- `ProfileForm` - 表单逻辑（可复用）
- `ValidationDisplay` - 验证错误展示
- `UserProfile` - 容器组件，组合以上

工作量：2-3 天
风险：中等（需要回归测试）
收益：后续开发效率提升 30%

### 选项 B: 使用 Composition API 重构
保持单文件，改用 Vue 3 Composition API：
- 逻辑按功能拆分（useAvatar, useForm, useValidation）
- 减少 props 传递，使用 provide/inject

工作量：1-2 天
风险：低（语法改动，逻辑不变）
收益：代码可读性提升，但复用性改善有限

## 测试覆盖
当前测试：单元测试 12 个，覆盖核心逻辑
需要补充：AvatarUploader 独立测试

## 回滚策略
分步重构，每步可独立回滚：
1. 先创建新组件（并行，不影响现有）
2. 逐步替换（feature flag 控制）
3. 完全替换后删除旧代码

请确认选择哪个方案？

## 期望输出

### 判定
Level 3 - 信息决策（技术选型，需要权衡）

### 语音版
组件重构，800行要拆分。提取子组件2到3天，复用好；Composition API1到2天。要收益还是速度？

### HUD版
L1: 🔄 UserProfile 重构
L2: A: 提取子组件（2-3天）
L3: B: Composition API（1-2天）
L4: 收益高 ← → 风险低

### 决策点
- 决策1: 重构方案 → 提取子组件（长期收益）/ Composition API（快速安全）

### 压缩摘要
两个方案：
- A: 提取子组件（4个），2-3天，高复用性，风险中等
- B: Composition API重构，1-2天，低风险，有限改善

当前测试覆盖12个，需要补充新组件测试。

## 测试说明
测试 Level 3 重构场景，考察 triage 能否：
1. 正确识别为 Level 3（单一决策，非多步骤计划）
2. 清晰呈现两个方案的权衡
3. 保留关键信息（工作量、风险、收益）
